---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

[![Travis build status](https://travis-ci.org/egnha/dub.svg?branch=master)](https://travis-ci.org/egnha/dub)
[![Coverage status](https://codecov.io/gh/egnha/dub/branch/master/graph/badge.svg)](https://codecov.io/github/egnha/dub?branch=master)
![Status](https://img.shields.io/badge/status-experimental-blue.svg)

# dub

_dub_ is a tiny R package that provides an operator `%<=%` that enables you to use pattern matching to selectively assign the (nested) components of a list or vector to names (_unpacking assignment_). Think of `<=` as a pictograph representing multiple `<-`'s.

The concise pattern matching syntax comes from [Haskell](https://en.wikibooks.org/wiki/Haskell/Pattern_matching). It mirrors the semantics of `list()`.

```{r}
library(dub)

(one : two : three) %<=% c(1, 2, 3)
one
two
three

(x) %<=% list(1)
x

((y : z)) %<=% list(list(1, list(2, 3)))
y
z

# Use . to drop specific components, ... to drop greedily (the _ in Haskell)
(a : (. : (. : b) : ... : c)) %<=% list(1, list(2, list(3, 4), 5, 6, 7))
a
b
c
```

## Installation

```{r gh-installation, eval = FALSE}
# install.packages("devtools")
devtools::install_github("egnha/dub")
```

## Desiderata

The main objective of dub is to cover the most common cases of unpacking assignment:

- assigning the top-level components of a list
- unpacking nested components

The pattern matching syntax should be economical and avoid conflict with R's established semantics. The code should be short and easy to grasp.

### Implementation

- dub appropriates `` `:` `` as a symbol concatenator, in a strictly localized context. There is no semantic conflict with the usual `` `:` ``, which is an operator of an altogether different type (namely, a range operator of integers).

- To keep the code short—under 60 lines—explicit validation is omitted.

The brevity of the code reflects the simplicity of unpacking assignment: the leaves of the left-hand side of `%<=%` are matched, via `<-`, with the leaves on the right-hand side. The only subtlety is to make `` `:` `` right-associative.

## Prior art

Unpacking/multiple assignment appears in other languages, e.g., [Python](https://docs.python.org/3/tutorial/datastructures.html#tuples-and-sequences) and [Javascript](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment). While R has no such feature, using a custom operator to do this has long been a folklore method. The earliest implementation that I could find is due to [Gabor Grothendieck](https://stat.ethz.ch/pipermail/r-help/2004-June/053343.html) (2004).

I recommend the [zeallot](https://github.com/nteetor/zeallot) package by [Nate Teetor](https://github.com/nteetor) as a more robust and full-featured option for unpacking assignment.

## License

MIT Copyright © 2018 [Eugene Ha](https://github.com/egnha)
